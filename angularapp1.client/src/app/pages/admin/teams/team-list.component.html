<div class="p-4">
  <app-notification [message]="notification()"></app-notification>

  <div class="flex justify-between items-center mb-4">
    <h2 class="text-2xl font-bold">Listado de Equipos</h2>

    <div class="flex gap-2">
      <!-- Búsqueda -->
      <input [ngModel]="search()" 
             (ngModelChange)="search.set($event)"
             (keyup.enter)="onSearch()"
             placeholder="Buscar por nombre o ciudad"
             class="border px-3 py-2 rounded w-64" />

      <button (click)="onSearch()"
              class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">
        Buscar
      </button>

      <!-- Filtro por ciudad -->
      <select [ngModel]="filterCity()" 
              (ngModelChange)="onFilterCity($event)"
              class="border px-3 py-2 rounded">
        <option value="">Todas las ciudades</option>
        <option *ngFor="let city of allCities" [value]="city">{{ city }}</option>
      </select>

      <!-- Nuevo equipo -->
      <a routerLink="new"
         class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">
        Nuevo Equipo
      </a>
    </div>
  </div>

  <!-- Estado de carga -->
  <div *ngIf="loading()" class="text-gray-500">Cargando...</div>

  <!-- Tabla -->
  <table *ngIf="teams.length > 0 && !loading()" class="min-w-full bg-white border border-gray-300">
    <thead class="bg-gray-200">
      <tr>
        <th class="px-4 py-2 text-left">ID</th>
        <th class="px-4 py-2 text-left">Nombre</th>
        <th class="px-4 py-2 text-left">Ciudad</th>
        <th class="px-4 py-2 text-left">Logo</th>
        <th class="px-4 py-2 text-left">Acciones</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let team of teams" class="border-t">
        <td class="px-4 py-2">{{ team.id }}</td>
        <td class="px-4 py-2">{{ team.name }}</td>
        <td class="px-4 py-2">{{ team.city }}</td>
        <td class="px-4 py-2">
          <img *ngIf="team.logoUrl" [src]="team.logoUrl" alt="logo" class="h-8 w-8" />
        </td>
        <td>
          <button (click)="editTeam(team.id)" class="bg-blue-500 text-white px-2 py-1 rounded hover:bg-blue-600">
            Editar
          </button>
          <button (click)="deleteTeam(team.id)" class="bg-red-500 text-white px-2 py-1 rounded hover:bg-red-600 ml-2">
            Eliminar
          </button>
        </td>
      </tr>
    </tbody>
  </table>

  <!-- Sin resultados -->
  <div *ngIf="!loading() && teams.length === 0" class="text-gray-500 mt-4">
    No hay equipos registrados.
  </div>

  <!-- Paginación -->
  <div class="flex justify-between mt-4" *ngIf="total() > size">
    <button (click)="prevPage()" [disabled]="page() === 1" class="px-3 py-1 bg-gray-200 rounded">
      Anterior
    </button>
    <span>Página {{ page() }} de {{ Math.ceil(total() / size) }}</span>
    <button (click)="nextPage()" [disabled]="page() * size >= total()" class="px-3 py-1 bg-gray-200 rounded">
      Siguiente
    </button>
  </div>
</div>
